---
params:
  report_title: ""
  local_authority: ""
  year: ""
  topic_data: ""
  comparison_type: ""
  comparator: ""
title: "`r params$report_title`"
output:
  pdf_document:
    toc: yes
    fig_caption: false
header-includes:
    - \hypersetup{colorlinks=true, linkcolor = black, urlcolor = [RGB]{0, 163, 163}}
    - \usepackage{titling}
    - \pretitle{\begin{center}
      \includegraphics[width=2in,height=2in]{../www/new_logo.png}\LARGE\\}
    - \posttitle{\end{center}}
    - \renewcommand{\familydefault}{\sfdefault}
classoption: landscape
fontsize: 10pt
papersize: a4
geometry: margin=1.5cm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE)
options(tinytex.verbose = TRUE)

library(knitr)
library(dplyr)
library(kableExtra)
library(png)
library(tidyselect)

local_authority <- params$local_authority
year <- params$year
topic_data <- params$topic_data
comparison_type <- params$comparison_type
comparator <- params$comparator

Table_10.1 <- topic_data[[1]]
Figure_10.1 <- topic_data[[2]]
Figure_10.2 <- topic_data[[3]]
Figure_10.3 <- topic_data[[4]]
Table_10.2 <- topic_data[[5]]
Table_10.3 <- topic_data[[6]]
Table_10.4 <- topic_data[[7]]
Table_10.5 <- topic_data[[8]]
Table_10.6 <- topic_data[[9]]
Table_10.7 <- topic_data[[10]]
Figure_10.4 <- topic_data[[11]]
Table_10.8 <- topic_data[[12]]
Table_10.9 <- topic_data[[13]]
Table_10.10 <- topic_data[[14]]
Figure_10.5 <- topic_data[[15]]
Table_10.11 <- topic_data[[16]]
Figure_10.6 <- topic_data[[17]]
Figure_10.7 <- topic_data[[18]]
Table_10.12 <- topic_data[[19]]
Table_10.13 <- topic_data[[20]]

main_table_title <- paste0(local_authority, ", ", year)

eval_comparison <- ifelse(comparison_type == "No comparison", FALSE, TRUE)

eval_comparison_time_series <- ifelse(comparison_type == "Year" | comparison_type == "No comparison", FALSE, TRUE)

comparison_table_title <- if (comparison_type == "Local Authority") {
  paste0(comparator, ", ", year)
} else if (comparison_type == "Year") {
  paste0(local_authority, ", ", comparator)
} else {
  NULL
  }

```

## Acknowledgements
The Scottish Government acknowledges and thanks the 10,530
people across Scotland who gave their time to take part in the
Scottish Household Survey 2018.
This report was produced by the Scottish Household Survey Project Team
at the Scottish Government.
We would also like to thank all the Scottish Government lead analysts who
contributed to the project.
Finally, special thanks to Ipsos MORI and their interviewers for continuous
and relentless efforts during the fieldwork.

## Key

```{=latex}
$ \color[RGB]{0, 163, 163} \blacksquare $ Significantly higher $ \color[RGB]{195, 195, 255} \blacksquare $ Significantly lower
```
## Table 10.1: Perceptions about climate change as a problem
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_10.1)) {
Table_10.1 %>%
kable("latex", escape = TRUE, booktabs = T) %>% column_spec(1, width = "20em")
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.1)) {
if (length(grep("_2", colnames(Table_10.1))) > 0) {
colnames(Table_10.1) <- gsub("%", "\\\\%", colnames(Table_10.1))
main_column_names <- colnames(Table_10.1)[!grepl("_2", colnames(Table_10.1))]
significance_column_names <- colnames(Table_10.1)[grepl("_sig", colnames(Table_10.1))]

Table_10.1 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% column_spec(1, width = "20em")
} else {
Table_10.1 %>%
kable("latex", escape = TRUE, booktabs = T) %>% column_spec(1, width = "20em")
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.1) && length(grep("_2", colnames(Table_10.1))) > 0) {
comparison_column_names <- colnames(Table_10.1)[grepl("_2", colnames(Table_10.1))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.1 %>% select(tidyselect::all_of(colnames(Table_10.1)[!colnames(Table_10.1) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T) %>% column_spec(1, width = "20em")
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Figure 10.1: Perception about climate change as an 'immediate and urgent problem' by age
### Column percentages, Adults
### Base sizes are too small for breakdown by age

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Figure_10.1)) {
Figure_10.1 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Figure_10.1)) {
if (length(grep("_2", colnames(Figure_10.1))) > 0) {
colnames(Figure_10.1) <- gsub("%", "\\\\%", colnames(Figure_10.1))
main_column_names <- colnames(Figure_10.1)[!grepl("_2", colnames(Figure_10.1))]
significance_column_names <- colnames(Figure_10.1)[grepl("_sig", colnames(Figure_10.1))]

Figure_10.1 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`16-39` = cell_spec(`16-39`, "latex", background = case_when(`16-39_sig` == "HIGHER" ~ "#00A3A3", `16-39_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`40-64` = cell_spec(`40-64`, "latex", background = case_when(`40-64_sig` == "HIGHER" ~ "#00A3A3", `40-64_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`65+` = cell_spec(`65+`, "latex", background = case_when(`65+_sig` == "HIGHER" ~ "#00A3A3", `65+_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Figure_10.1 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Figure_10.1) && length(grep("_2", colnames(Figure_10.1))) > 0) {
comparison_column_names <- colnames(Figure_10.1)[grepl("_2", colnames(Figure_10.1))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_10.1 %>% select(tidyselect::all_of(colnames(Figure_10.1)[!colnames(Figure_10.1) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`16-39` = cell_spec(`16-39`, "latex", background = case_when(`16-39_sig` == "HIGHER" ~ "#C3C3FF", `16-39_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`40-64` = cell_spec(`40-64`, "latex", background = case_when(`40-64_sig` == "HIGHER" ~ "#C3C3FF", `40-64_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`65+` = cell_spec(`65+`, "latex", background = case_when(`65+_sig` == "HIGHER" ~ "#C3C3FF", `65+_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Figure 10.2: Percentage of adults perceiving that 'Climate change is an immediate and urgent problem' by educational attainment
### Base numbers at local authority level are too small to produce robust analysis.
### Base sizes are too small for breakdown by educational attainment. See Figure 10.1 for breakdown by year
## Figure 10.3: Percentage of adults perceiving that 'Climate change is an immediate and urgent problem' by area deprivation
### Base numbers at local authority level are too small to produce robust analysis.
### Base sizes are too small for breakdown by area deprivation. See Figure 10.1 for breakdown by year
## Table 10.2: 'It’s not worth me doing things to help the environment if others don’t do the same”
### Column percentages, Adults
### Data for 2016/prior to 2015 not available

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_10.2)) {
Table_10.2 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.2)) {
if (length(grep("_2", colnames(Table_10.2))) > 0) {
colnames(Table_10.2) <- gsub("%", "\\\\%", colnames(Table_10.2))
main_column_names <- colnames(Table_10.2)[!grepl("_2", colnames(Table_10.2))]
significance_column_names <- colnames(Table_10.2)[grepl("_sig", colnames(Table_10.2))]

Table_10.2 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.2 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.2) && length(grep("_2", colnames(Table_10.2))) > 0) {
comparison_column_names <- colnames(Table_10.2)[grepl("_2", colnames(Table_10.2))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.2 %>% select(tidyselect::all_of(colnames(Table_10.2)[!colnames(Table_10.2) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.3: 'I don’t believe my behaviour and everyday lifestyle contribute to climate change'
### Column percentages, Adults
### Data for 2016/prior to 2015 not available

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_10.3)) {
Table_10.3 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.3)) {
if (length(grep("_2", colnames(Table_10.3))) > 0) {
colnames(Table_10.3) <- gsub("%", "\\\\%", colnames(Table_10.3))
main_column_names <- colnames(Table_10.3)[!grepl("_2", colnames(Table_10.3))]
significance_column_names <- colnames(Table_10.3)[grepl("_sig", colnames(Table_10.3))]

Table_10.3 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.3 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.3) && length(grep("_2", colnames(Table_10.3))) > 0) {
comparison_column_names <- colnames(Table_10.3)[grepl("_2", colnames(Table_10.3))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.3 %>% select(tidyselect::all_of(colnames(Table_10.3)[!colnames(Table_10.3) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.4: 'Climate change will only have an impact on other countries, there is no need for me to worry'
### Column percentages, Adults
### Data for 2016/prior to 2015 not available

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_10.4)) {
Table_10.4 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.4)) {
if (length(grep("_2", colnames(Table_10.4))) > 0) {
colnames(Table_10.4) <- gsub("%", "\\\\%", colnames(Table_10.4))
main_column_names <- colnames(Table_10.4)[!grepl("_2", colnames(Table_10.4))]
significance_column_names <- colnames(Table_10.4)[grepl("_sig", colnames(Table_10.4))]

Table_10.4 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.4 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.4) && length(grep("_2", colnames(Table_10.4))) > 0) {
comparison_column_names <- colnames(Table_10.4)[grepl("_2", colnames(Table_10.4))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.4 %>% select(tidyselect::all_of(colnames(Table_10.4)[!colnames(Table_10.4) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.5: 'I understand what actions people like myself should take to help tackle climate change'
### Column percentages, Adults
### Data for 2016/prior to 2015 not available

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_10.5)) {
Table_10.5 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.5)) {
if (length(grep("_2", colnames(Table_10.5))) > 0) {
colnames(Table_10.5) <- gsub("%", "\\\\%", colnames(Table_10.5))
main_column_names <- colnames(Table_10.5)[!grepl("_2", colnames(Table_10.5))]
significance_column_names <- colnames(Table_10.5)[grepl("_sig", colnames(Table_10.5))]

Table_10.5 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.5 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.5) && length(grep("_2", colnames(Table_10.5))) > 0) {
comparison_column_names <- colnames(Table_10.5)[grepl("_2", colnames(Table_10.5))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.5 %>% select(tidyselect::all_of(colnames(Table_10.5)[!colnames(Table_10.5) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.6: Frequency of visits made to the outdoors
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_10.6)) {
Table_10.6 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.6)) {
if (length(grep("_2", colnames(Table_10.6))) > 0) {
colnames(Table_10.6) <- gsub("%", "\\\\%", colnames(Table_10.6))
main_column_names <- colnames(Table_10.6)[!grepl("_2", colnames(Table_10.6))]
significance_column_names <- colnames(Table_10.6)[grepl("_sig", colnames(Table_10.6))]

Table_10.6 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#00A3A3", `2011_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#00A3A3", `2012_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.6 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.6) && length(grep("_2", colnames(Table_10.6))) > 0) {
comparison_column_names <- colnames(Table_10.6)[grepl("_2", colnames(Table_10.6))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.6 %>% select(tidyselect::all_of(colnames(Table_10.6)[!colnames(Table_10.6) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#C3C3FF", `2011_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#C3C3FF", `2012_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.7: Frequency of visits made to the outdoors by Scottish Index of Multiple Deprivation
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_10.7)) {
Table_10.7 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_10.7)) {
if (length(grep("_2", colnames(Table_10.7))) > 0) {
colnames(Table_10.7) <- gsub("%", "\\\\%", colnames(Table_10.7))
main_column_names <- colnames(Table_10.7)[!grepl("_2", colnames(Table_10.7))]
significance_column_names <- colnames(Table_10.7)[grepl("_sig", colnames(Table_10.7))]

Table_10.7 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`1 - 20\\% most deprived` = cell_spec(`1 - 20\\% most deprived`, "latex", background = case_when(`1 - 20\\% most deprived_sig` == "HIGHER" ~ "#00A3A3", `1 - 20\\% most deprived_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2` = cell_spec(`2`, "latex", background = case_when(`2_sig` == "HIGHER" ~ "#00A3A3", `2_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`3` = cell_spec(`3`, "latex", background = case_when(`3_sig` == "HIGHER" ~ "#00A3A3", `3_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`4` = cell_spec(`4`, "latex", background = case_when(`4_sig` == "HIGHER" ~ "#00A3A3", `4_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`5 - 20\\% least deprived` = cell_spec(`5 - 20\\% least deprived`, "latex", background = case_when(`5 - 20\\% least deprived_sig` == "HIGHER" ~ "#00A3A3", `5 - 20\\% least deprived_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.7 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_10.7) && length(grep("_2", colnames(Table_10.7))) > 0) {
comparison_column_names <- colnames(Table_10.7)[grepl("_2", colnames(Table_10.7))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.7 %>% select(tidyselect::all_of(colnames(Table_10.7)[!colnames(Table_10.7) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`1 - 20\\% most deprived` = cell_spec(`1 - 20\\% most deprived`, "latex", background = case_when(`1 - 20\\% most deprived_sig` == "HIGHER" ~ "#C3C3FF", `1 - 20\\% most deprived_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2` = cell_spec(`2`, "latex", background = case_when(`2_sig` == "HIGHER" ~ "#C3C3FF", `2_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`3` = cell_spec(`3`, "latex", background = case_when(`3_sig` == "HIGHER" ~ "#C3C3FF", `3_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`4` = cell_spec(`4`, "latex", background = case_when(`4_sig` == "HIGHER" ~ "#C3C3FF", `4_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`5 - 20\\% least deprived` = cell_spec(`5 - 20\\% least deprived`, "latex", background = case_when(`5 - 20\\% least deprived_sig` == "HIGHER" ~ "#C3C3FF", `5 - 20\\% least deprived_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Figure 10.4: Percentage of adults visiting outdoors at least once a week
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_10.4)) {
Figure_10.4 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.4)) {
if (length(grep("_2", colnames(Figure_10.4))) > 0) {
colnames(Figure_10.4) <- gsub("%", "\\\\%", colnames(Figure_10.4))
main_column_names <- colnames(Figure_10.4)[!grepl("_2", colnames(Figure_10.4))]
significance_column_names <- colnames(Figure_10.4)[grepl("_sig", colnames(Figure_10.4))]

Figure_10.4 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Figure_10.4 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.4) && length(grep("_2", colnames(Figure_10.4))) > 0) {
comparison_column_names <- colnames(Figure_10.4)[grepl("_2", colnames(Figure_10.4))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_10.4 %>% select(tidyselect::all_of(colnames(Figure_10.4)[!colnames(Figure_10.4) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.8: Frequency of visits made to the outdoors by urban/rural classification
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_10.8)) {
Table_10.8 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_10.8)) {
if (length(grep("_2", colnames(Table_10.8))) > 0) {
colnames(Table_10.8) <- gsub("%", "\\\\%", colnames(Table_10.8))
main_column_names <- colnames(Table_10.8)[!grepl("_2", colnames(Table_10.8))]
significance_column_names <- colnames(Table_10.8)[grepl("_sig", colnames(Table_10.8))]

Table_10.8 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Urban areas` = cell_spec(`Urban areas`, "latex", background = case_when(`Urban areas_sig` == "HIGHER" ~ "#00A3A3", `Urban areas_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Rural areas` = cell_spec(`Rural areas`, "latex", background = case_when(`Rural areas_sig` == "HIGHER" ~ "#00A3A3", `Rural areas_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.8 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_10.8) && length(grep("_2", colnames(Table_10.8))) > 0) {
comparison_column_names <- colnames(Table_10.8)[grepl("_2", colnames(Table_10.8))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.8 %>% select(tidyselect::all_of(colnames(Table_10.8)[!colnames(Table_10.8) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Urban areas` = cell_spec(`Urban areas`, "latex", background = case_when(`Urban areas_sig` == "HIGHER" ~ "#C3C3FF", `Urban areas_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Rural areas` = cell_spec(`Rural areas`, "latex", background = case_when(`Rural areas_sig` == "HIGHER" ~ "#C3C3FF", `Rural areas_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.9: Frequency of visits made to the outdoors by age group and gender
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_10.9)) {
Table_10.9 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_10.9)) {
if (length(grep("_2", colnames(Table_10.9))) > 0) {
colnames(Table_10.9) <- gsub("%", "\\\\%", colnames(Table_10.9))
main_column_names <- colnames(Table_10.9)[!grepl("_2", colnames(Table_10.9))]
significance_column_names <- colnames(Table_10.9)[grepl("_sig", colnames(Table_10.9))]

Table_10.9 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Male` = cell_spec(`Male`, "latex", background = case_when(`Male_sig` == "HIGHER" ~ "#00A3A3", `Male_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Female` = cell_spec(`Female`, "latex", background = case_when(`Female_sig` == "HIGHER" ~ "#00A3A3", `Female_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`In another way` = cell_spec(`In another way`, "latex", background = case_when(`In another way_sig` == "HIGHER" ~ "#00A3A3", `In another way_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Refused` = cell_spec(`Refused`, "latex", background = case_when(`Refused_sig` == "HIGHER" ~ "#00A3A3", `Refused_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`16-39` = cell_spec(`16-39`, "latex", background = case_when(`16-39_sig` == "HIGHER" ~ "#00A3A3", `16-39_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`40-64` = cell_spec(`40-64`, "latex", background = case_when(`40-64_sig` == "HIGHER" ~ "#00A3A3", `40-64_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`65+` = cell_spec(`65+`, "latex", background = case_when(`65+_sig` == "HIGHER" ~ "#00A3A3", `65+_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.9 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_10.9) && length(grep("_2", colnames(Table_10.9))) > 0) {
comparison_column_names <- colnames(Table_10.9)[grepl("_2", colnames(Table_10.9))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.9 %>% select(tidyselect::all_of(colnames(Table_10.9)[!colnames(Table_10.9) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Male` = cell_spec(`Male`, "latex", background = case_when(`Male_sig` == "HIGHER" ~ "#C3C3FF", `Male_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Female` = cell_spec(`Female`, "latex", background = case_when(`Female_sig` == "HIGHER" ~ "#C3C3FF", `Female_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`In another way` = cell_spec(`In another way`, "latex", background = case_when(`In another way_sig` == "HIGHER" ~ "#C3C3FF", `In another way_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Refused` = cell_spec(`Refused`, "latex", background = case_when(`Refused_sig` == "HIGHER" ~ "#C3C3FF", `Refused_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`16-39` = cell_spec(`16-39`, "latex", background = case_when(`16-39_sig` == "HIGHER" ~ "#C3C3FF", `16-39_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`40-64` = cell_spec(`40-64`, "latex", background = case_when(`40-64_sig` == "HIGHER" ~ "#C3C3FF", `40-64_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`65+` = cell_spec(`65+`, "latex", background = case_when(`65+_sig` == "HIGHER" ~ "#C3C3FF", `65+_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.10: Frequency of visits made to the outdoors by self perception of health
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_10.10)) {
Table_10.10 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_10.10)) {
if (length(grep("_2", colnames(Table_10.10))) > 0) {
colnames(Table_10.10) <- gsub("%", "\\\\%", colnames(Table_10.10))
main_column_names <- colnames(Table_10.10)[!grepl("_2", colnames(Table_10.10))]
significance_column_names <- colnames(Table_10.10)[grepl("_sig", colnames(Table_10.10))]

Table_10.10 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Bad / very bad` = cell_spec(`Bad / very bad`, "latex", background = case_when(`Bad / very bad_sig` == "HIGHER" ~ "#00A3A3", `Bad / very bad_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Good / very good` = cell_spec(`Good / very good`, "latex", background = case_when(`Good / very good_sig` == "HIGHER" ~ "#00A3A3", `Good / very good_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Fair` = cell_spec(`Fair`, "latex", background = case_when(`Fair_sig` == "HIGHER" ~ "#00A3A3", `Fair_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.10 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_10.10) && length(grep("_2", colnames(Table_10.10))) > 0) {
comparison_column_names <- colnames(Table_10.10)[grepl("_2", colnames(Table_10.10))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.10 %>% select(tidyselect::all_of(colnames(Table_10.10)[!colnames(Table_10.10) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Bad / very bad` = cell_spec(`Bad / very bad`, "latex", background = case_when(`Bad / very bad_sig` == "HIGHER" ~ "#C3C3FF", `Bad / very bad_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Good / very good` = cell_spec(`Good / very good`, "latex", background = case_when(`Good / very good_sig` == "HIGHER" ~ "#C3C3FF", `Good / very good_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Fair` = cell_spec(`Fair`, "latex", background = case_when(`Fair_sig` == "HIGHER" ~ "#C3C3FF", `Fair_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Figure 10.5: Walking distance to nearest useable greenspace
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_10.5)) {
Figure_10.5 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.5)) {
if (length(grep("_2", colnames(Figure_10.5))) > 0) {
colnames(Figure_10.5) <- gsub("%", "\\\\%", colnames(Figure_10.5))
main_column_names <- colnames(Figure_10.5)[!grepl("_2", colnames(Figure_10.5))]
significance_column_names <- colnames(Figure_10.5)[grepl("_sig", colnames(Figure_10.5))]

Figure_10.5 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Figure_10.5 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.5) && length(grep("_2", colnames(Figure_10.5))) > 0) {
comparison_column_names <- colnames(Figure_10.5)[grepl("_2", colnames(Figure_10.5))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_10.5 %>% select(tidyselect::all_of(colnames(Figure_10.5)[!colnames(Figure_10.5) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.11: Walking distance to nearest greenspace by Scottish Index of Multiple Deprivation
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_10.11)) {
Table_10.11 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_10.11)) {
if (length(grep("_2", colnames(Table_10.11))) > 0) {
colnames(Table_10.11) <- gsub("%", "\\\\%", colnames(Table_10.11))
main_column_names <- colnames(Table_10.11)[!grepl("_2", colnames(Table_10.11))]
significance_column_names <- colnames(Table_10.11)[grepl("_sig", colnames(Table_10.11))]

Table_10.11 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`1 - 20\\% most deprived` = cell_spec(`1 - 20\\% most deprived`, "latex", background = case_when(`1 - 20\\% most deprived_sig` == "HIGHER" ~ "#00A3A3", `1 - 20\\% most deprived_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2` = cell_spec(`2`, "latex", background = case_when(`2_sig` == "HIGHER" ~ "#00A3A3", `2_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`3` = cell_spec(`3`, "latex", background = case_when(`3_sig` == "HIGHER" ~ "#00A3A3", `3_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`4` = cell_spec(`4`, "latex", background = case_when(`4_sig` == "HIGHER" ~ "#00A3A3", `4_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`5 - 20\\% least deprived` = cell_spec(`5 - 20\\% least deprived`, "latex", background = case_when(`5 - 20\\% least deprived_sig` == "HIGHER" ~ "#00A3A3", `5 - 20\\% least deprived_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.11 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_10.11) && length(grep("_2", colnames(Table_10.11))) > 0) {
comparison_column_names <- colnames(Table_10.11)[grepl("_2", colnames(Table_10.11))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.11 %>% select(tidyselect::all_of(colnames(Table_10.11)[!colnames(Table_10.11) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`1 - 20\\% most deprived` = cell_spec(`1 - 20\\% most deprived`, "latex", background = case_when(`1 - 20\\% most deprived_sig` == "HIGHER" ~ "#C3C3FF", `1 - 20\\% most deprived_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2` = cell_spec(`2`, "latex", background = case_when(`2_sig` == "HIGHER" ~ "#C3C3FF", `2_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`3` = cell_spec(`3`, "latex", background = case_when(`3_sig` == "HIGHER" ~ "#C3C3FF", `3_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`4` = cell_spec(`4`, "latex", background = case_when(`4_sig` == "HIGHER" ~ "#C3C3FF", `4_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`5 - 20\\% least deprived` = cell_spec(`5 - 20\\% least deprived`, "latex", background = case_when(`5 - 20\\% least deprived_sig` == "HIGHER" ~ "#C3C3FF", `5 - 20\\% least deprived_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Figure 10.6: Percentage of adults expressing satisfaction with nearest greenspace
### Column percentages, Adults
### Question not asked in 2018. Base numbers too small to show line chart for local authorities.
### [Another breakdown of this table can be found at the Scottish Surveys Core Questions](https://www2.gov.scot/Topics/Statistics/About/Surveys/SSCQ)

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_10.6)) {
Figure_10.6 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.6)) {
if (length(grep("_2", colnames(Figure_10.6))) > 0) {
colnames(Figure_10.6) <- gsub("%", "\\\\%", colnames(Figure_10.6))
main_column_names <- colnames(Figure_10.6)[!grepl("_2", colnames(Figure_10.6))]
significance_column_names <- colnames(Figure_10.6)[grepl("_sig", colnames(Figure_10.6))]

Figure_10.6 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Figure_10.6 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.6) && length(grep("_2", colnames(Figure_10.6))) > 0) {
comparison_column_names <- colnames(Figure_10.6)[grepl("_2", colnames(Figure_10.6))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_10.6 %>% select(tidyselect::all_of(colnames(Figure_10.6)[!colnames(Figure_10.6) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Figure 10.7: Percentage of adults who have not visited nearest greenspace in previous 12 months
### Column percentages, Adults
### Question not asked in 2018. Base numbers too small to show line chart for local authorities.

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_10.7)) {
Figure_10.7 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.7)) {
if (length(grep("_2", colnames(Figure_10.7))) > 0) {
colnames(Figure_10.7) <- gsub("%", "\\\\%", colnames(Figure_10.7))
main_column_names <- colnames(Figure_10.7)[!grepl("_2", colnames(Figure_10.7))]
significance_column_names <- colnames(Figure_10.7)[grepl("_sig", colnames(Figure_10.7))]

Figure_10.7 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Figure_10.7 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_10.7) && length(grep("_2", colnames(Figure_10.7))) > 0) {
comparison_column_names <- colnames(Figure_10.7)[grepl("_2", colnames(Figure_10.7))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_10.7 %>% select(tidyselect::all_of(colnames(Figure_10.7)[!colnames(Figure_10.7) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.12: Percentage of people who gave their views on land use in the last 12 months
### Column percentages, Adults
### Columns may not add up to 100 per cent as multiple responses were allowed

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_10.12)) {
Table_10.12 %>%
kable("latex", escape = TRUE, booktabs = T) %>% column_spec(1, width = "20em")
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.12)) {
if (length(grep("_2", colnames(Table_10.12))) > 0) {
colnames(Table_10.12) <- gsub("%", "\\\\%", colnames(Table_10.12))
main_column_names <- colnames(Table_10.12)[!grepl("_2", colnames(Table_10.12))]
significance_column_names <- colnames(Table_10.12)[grepl("_sig", colnames(Table_10.12))]

Table_10.12 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% column_spec(1, width = "20em")
} else {
Table_10.12 %>%
kable("latex", escape = TRUE, booktabs = T) %>% column_spec(1, width = "20em")
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_10.12) && length(grep("_2", colnames(Table_10.12))) > 0) {
comparison_column_names <- colnames(Table_10.12)[grepl("_2", colnames(Table_10.12))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.12 %>% select(tidyselect::all_of(colnames(Table_10.12)[!colnames(Table_10.12) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T) %>% column_spec(1, width = "20em")
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
## Table 10.13: Percentage of People who gave their views on land use by urban rural classification
### Column percentages, Adults
### Data for 2016/prior to 2015 not available

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_10.13)) {
Table_10.13 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_10.13)) {
if (length(grep("_2", colnames(Table_10.13))) > 0) {
colnames(Table_10.13) <- gsub("%", "\\\\%", colnames(Table_10.13))
main_column_names <- colnames(Table_10.13)[!grepl("_2", colnames(Table_10.13))]
significance_column_names <- colnames(Table_10.13)[grepl("_sig", colnames(Table_10.13))]

Table_10.13 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Urban areas` = cell_spec(`Urban areas`, "latex", background = case_when(`Urban areas_sig` == "HIGHER" ~ "#00A3A3", `Urban areas_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Rural areas` = cell_spec(`Rural areas`, "latex", background = case_when(`Rural areas_sig` == "HIGHER" ~ "#00A3A3", `Rural areas_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_10.13 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_10.13) && length(grep("_2", colnames(Table_10.13))) > 0) {
comparison_column_names <- colnames(Table_10.13)[grepl("_2", colnames(Table_10.13))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_10.13 %>% select(tidyselect::all_of(colnames(Table_10.13)[!colnames(Table_10.13) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Urban areas` = cell_spec(`Urban areas`, "latex", background = case_when(`Urban areas_sig` == "HIGHER" ~ "#C3C3FF", `Urban areas_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Rural areas` = cell_spec(`Rural areas`, "latex", background = case_when(`Rural areas_sig` == "HIGHER" ~ "#C3C3FF", `Rural areas_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters, or there is no data to compare with.")
}
```
