---
params:
  report_title: ""
  local_authority: ""
  year: ""
  topic_data: ""
  comparison_type: ""
  comparator: ""
title: "`r params$report_title`"
output:
  pdf_document:
    toc: yes
    fig_caption: false
header-includes:
    - \hypersetup{colorlinks=true, linkcolor = black, urlcolor = [RGB]{0, 163, 163}}
    - \usepackage{titling}
    - \pretitle{\begin{center}
      \includegraphics[width=2in,height=2in]{../www/new_logo.png}\LARGE\\}
    - \posttitle{\end{center}}
    - \renewcommand{\familydefault}{\sfdefault}
classoption: landscape
fontsize: 10pt
papersize: a4
geometry: margin=1.5cm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE)
options(tinytex.verbose = TRUE)

library(knitr)
library(dplyr)
library(kableExtra)
library(png)
library(tidyselect)

local_authority <- params$local_authority
year <- params$year
topic_data <- params$topic_data
comparison_type <- params$comparison_type
comparator <- params$comparator

Figure_3.1 <- topic_data[[1]]
Table_3.1 <- topic_data[[2]]
Table_3.1b <- topic_data[[3]]
Figure_3.2 <- topic_data[[4]]
Figure_3.3 <- topic_data[[5]]
Figure_3.4 <- topic_data[[6]]
Figure_3.5 <- topic_data[[7]]
Table_3.2a <- topic_data[[8]]
Table_3.2b <- topic_data[[9]]
Table_3.2c <- topic_data[[10]]
Table_3.2d <- topic_data[[11]]
Table_3.3a <- topic_data[[12]]
Table_3.3b <- topic_data[[13]]
Table_3.3c <- topic_data[[14]]
Table_3.3d <- topic_data[[15]]
Table_3.3e <- topic_data[[16]]
Table_3.3f <- topic_data[[17]]
Table_3.4a <- topic_data[[18]]
Table_3.4b <- topic_data[[19]]
Table_3.4c <- topic_data[[20]]
Table_3.4d <- topic_data[[21]]
Table_3.4e <- topic_data[[22]]
Table_3.5a <- topic_data[[23]]
Table_3.5b <- topic_data[[24]]
Table_3.6a <- topic_data[[25]]
Table_3.6b <- topic_data[[26]]
Table_3.6c <- topic_data[[27]]
Figure_3.6 <- topic_data[[28]]
Table_3.7a <- topic_data[[29]]
Table_3.7b <- topic_data[[30]]
Table_3.7c <- topic_data[[31]]
Table_3.8 <- topic_data[[32]]
Table_3.9a <- topic_data[[33]]
Table_3.9b <- topic_data[[34]]
Table_3.9c <- topic_data[[35]]
Table_3.10a <- topic_data[[36]]
Table_3.10b <- topic_data[[37]]
Table_3.11a <- topic_data[[38]]
Table_3.11b <- topic_data[[39]]
Table_3.11c <- topic_data[[40]]
Table_3.11d <- topic_data[[41]]
Table_3.11e <- topic_data[[42]]
Table_3.12 <- topic_data[[43]]
Table_3.13 <- topic_data[[44]]
Table_3.14 <- topic_data[[45]]
Table_3.15 <- topic_data[[46]]
Table_3.16 <- topic_data[[47]]
Table_3.17 <- topic_data[[48]]
Table_3.18 <- topic_data[[49]]

main_table_title <- paste0(local_authority, ", ", year)

eval_comparison <- ifelse(comparison_type == "No comparison", FALSE, TRUE)

eval_comparison_time_series <- ifelse(comparison_type == "Year" | comparison_type == "No comparison", FALSE, TRUE)

comparison_table_title <- if (comparison_type == "Local Authority") {
  paste0(comparator, ", ", year)
} else if (comparison_type == "Year") {
  paste0(local_authority, ", ", comparator)
} else {
  NULL
  }

```

## Acknowledgements
The Scottish Government acknowledges and thanks the 10,530
people across Scotland who gave their time to take part in the
Scottish Household Survey 2018.
This report was produced by the Scottish Household Survey Project Team
at the Scottish Government.
We would also like to thank all the Scottish Government lead analysts who
contributed to the project.
Finally, special thanks to Ipsos MORI and their interviewers for continuous
and relentless efforts during the fieldwork.

## Key

```{=latex}
$ \color[RGB]{0, 163, 163} \blacksquare $ Significantly higher $ \color[RGB]{195, 195, 255} \blacksquare $ Significantly lower
```
## Figure 3.1: Tenure of households by year
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_3.1)) {
Figure_3.1 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.1)) {
if (length(grep("_2", colnames(Figure_3.1))) > 0) {
colnames(Figure_3.1) <- gsub("%", "\\\\%", colnames(Figure_3.1))
main_column_names <- colnames(Figure_3.1)[!grepl("_2", colnames(Figure_3.1))]
significance_column_names <- colnames(Figure_3.1)[grepl("_sig", colnames(Figure_3.1))]

Figure_3.1 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#00A3A3", `1999_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#00A3A3", `2000_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#00A3A3", `2001_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#00A3A3", `2002_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#00A3A3", `2003_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#00A3A3", `2004_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#00A3A3", `2005_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#00A3A3", `2006_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#00A3A3", `2007_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#00A3A3", `2008_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#00A3A3", `2009_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#00A3A3", `2010_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#00A3A3", `2011_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#00A3A3", `2012_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
Figure_3.1 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.1) && length(grep("_2", colnames(Figure_3.1))) > 0) {
comparison_column_names <- colnames(Figure_3.1)[grepl("_2", colnames(Figure_3.1))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_3.1 %>% select(tidyselect::all_of(colnames(Figure_3.1)[!colnames(Figure_3.1) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#C3C3FF", `1999_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#C3C3FF", `2000_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#C3C3FF", `2001_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#C3C3FF", `2002_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#C3C3FF", `2003_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#C3C3FF", `2004_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#C3C3FF", `2005_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#C3C3FF", `2006_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#C3C3FF", `2007_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#C3C3FF", `2008_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#C3C3FF", `2009_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#C3C3FF", `2010_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#C3C3FF", `2011_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#C3C3FF", `2012_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.1: Tenure of household by year
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_3.1)) {
Table_3.1 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_3.1)) {
if (length(grep("_2", colnames(Table_3.1))) > 0) {
colnames(Table_3.1) <- gsub("%", "\\\\%", colnames(Table_3.1))
main_column_names <- colnames(Table_3.1)[!grepl("_2", colnames(Table_3.1))]
significance_column_names <- colnames(Table_3.1)[grepl("_sig", colnames(Table_3.1))]

Table_3.1 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#00A3A3", `1999_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#00A3A3", `2000_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#00A3A3", `2001_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#00A3A3", `2002_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#00A3A3", `2003_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#00A3A3", `2004_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#00A3A3", `2005_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#00A3A3", `2006_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#00A3A3", `2007_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#00A3A3", `2008_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#00A3A3", `2009_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#00A3A3", `2010_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#00A3A3", `2011_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#00A3A3", `2012_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
Table_3.1 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_3.1) && length(grep("_2", colnames(Table_3.1))) > 0) {
comparison_column_names <- colnames(Table_3.1)[grepl("_2", colnames(Table_3.1))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.1 %>% select(tidyselect::all_of(colnames(Table_3.1)[!colnames(Table_3.1) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#C3C3FF", `1999_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#C3C3FF", `2000_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#C3C3FF", `2001_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#C3C3FF", `2002_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#C3C3FF", `2003_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#C3C3FF", `2004_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#C3C3FF", `2005_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#C3C3FF", `2006_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#C3C3FF", `2007_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#C3C3FF", `2008_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#C3C3FF", `2009_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#C3C3FF", `2010_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#C3C3FF", `2011_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#C3C3FF", `2012_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.1b: Households by tenure and year
### Grossed-up estimates (Rounded to the nearest 10,000)
### 1999-2000 estimates are based on 2001 census data, all other years are based on 2011 census data. To compare of differences are significant please see Table 3.1
### [Household estimates obtained from National Records for Scotland](https://www.nrscotland.gov.uk/statistics-and-data/statistics/statistics-by-theme/households/household-estimates)

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
Table_3.1b %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
```
```{r eval=eval_comparison_time_series}
main_column_names <- colnames(Table_3.1b)[!grepl("_2", colnames(Table_3.1b))]

Table_3.1b %>% select(tidyselect::all_of(main_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
comparison_column_names <- colnames(Table_3.1b)[grepl("_2", colnames(Table_3.1b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.1b %>% select(tidyselect::all_of(colnames(Table_3.1b)[!colnames(Table_3.1b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
```
## Figure 3.2: Households by age of highest income householder
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_3.2)) {
Figure_3.2 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.2)) {
if (length(grep("_2", colnames(Figure_3.2))) > 0) {
colnames(Figure_3.2) <- gsub("%", "\\\\%", colnames(Figure_3.2))
main_column_names <- colnames(Figure_3.2)[!grepl("_2", colnames(Figure_3.2))]
significance_column_names <- colnames(Figure_3.2)[grepl("_sig", colnames(Figure_3.2))]

Figure_3.2 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#00A3A3", `1999_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#00A3A3", `2000_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#00A3A3", `2001_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#00A3A3", `2002_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#00A3A3", `2003_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#00A3A3", `2004_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#00A3A3", `2005_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#00A3A3", `2006_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#00A3A3", `2007_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#00A3A3", `2008_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#00A3A3", `2009_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#00A3A3", `2010_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#00A3A3", `2011_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#00A3A3", `2012_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
Figure_3.2 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.2) && length(grep("_2", colnames(Figure_3.2))) > 0) {
comparison_column_names <- colnames(Figure_3.2)[grepl("_2", colnames(Figure_3.2))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_3.2 %>% select(tidyselect::all_of(colnames(Figure_3.2)[!colnames(Figure_3.2) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#C3C3FF", `1999_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#C3C3FF", `2000_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#C3C3FF", `2001_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#C3C3FF", `2002_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#C3C3FF", `2003_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#C3C3FF", `2004_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#C3C3FF", `2005_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#C3C3FF", `2006_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#C3C3FF", `2007_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#C3C3FF", `2008_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#C3C3FF", `2009_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#C3C3FF", `2010_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#C3C3FF", `2011_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#C3C3FF", `2012_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Figure 3.3: Tenure of households by year (HIH aged 16 to 34)
### Base numbers at local authority level are too small to produce robust analysis.
## Figure 3.4: Tenure of households by year (HIH aged 35 to 59)
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_3.4)) {
Figure_3.4 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.4)) {
if (length(grep("_2", colnames(Figure_3.4))) > 0) {
colnames(Figure_3.4) <- gsub("%", "\\\\%", colnames(Figure_3.4))
main_column_names <- colnames(Figure_3.4)[!grepl("_2", colnames(Figure_3.4))]
significance_column_names <- colnames(Figure_3.4)[grepl("_sig", colnames(Figure_3.4))]

Figure_3.4 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#00A3A3", `1999_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#00A3A3", `2000_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#00A3A3", `2001_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#00A3A3", `2002_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#00A3A3", `2003_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#00A3A3", `2004_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#00A3A3", `2005_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#00A3A3", `2006_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#00A3A3", `2007_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#00A3A3", `2008_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#00A3A3", `2009_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#00A3A3", `2010_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#00A3A3", `2011_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#00A3A3", `2012_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
Figure_3.4 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.4) && length(grep("_2", colnames(Figure_3.4))) > 0) {
comparison_column_names <- colnames(Figure_3.4)[grepl("_2", colnames(Figure_3.4))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_3.4 %>% select(tidyselect::all_of(colnames(Figure_3.4)[!colnames(Figure_3.4) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#C3C3FF", `1999_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#C3C3FF", `2000_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#C3C3FF", `2001_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#C3C3FF", `2002_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#C3C3FF", `2003_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#C3C3FF", `2004_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#C3C3FF", `2005_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#C3C3FF", `2006_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#C3C3FF", `2007_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#C3C3FF", `2008_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#C3C3FF", `2009_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#C3C3FF", `2010_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#C3C3FF", `2011_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#C3C3FF", `2012_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Figure 3.5: Tenure of households by year (HIH aged 60 plus)
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_3.5)) {
Figure_3.5 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.5)) {
if (length(grep("_2", colnames(Figure_3.5))) > 0) {
colnames(Figure_3.5) <- gsub("%", "\\\\%", colnames(Figure_3.5))
main_column_names <- colnames(Figure_3.5)[!grepl("_2", colnames(Figure_3.5))]
significance_column_names <- colnames(Figure_3.5)[grepl("_sig", colnames(Figure_3.5))]

Figure_3.5 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#00A3A3", `1999_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#00A3A3", `2000_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#00A3A3", `2001_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#00A3A3", `2002_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#00A3A3", `2003_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#00A3A3", `2004_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#00A3A3", `2005_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#00A3A3", `2006_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#00A3A3", `2007_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#00A3A3", `2008_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#00A3A3", `2009_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#00A3A3", `2010_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#00A3A3", `2011_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#00A3A3", `2012_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
Figure_3.5 %>%
kable("latex", escape = TRUE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.5) && length(grep("_2", colnames(Figure_3.5))) > 0) {
comparison_column_names <- colnames(Figure_3.5)[grepl("_2", colnames(Figure_3.5))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_3.5 %>% select(tidyselect::all_of(colnames(Figure_3.5)[!colnames(Figure_3.5) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`1999` = cell_spec(`1999`, "latex", background = case_when(`1999_sig` == "HIGHER" ~ "#C3C3FF", `1999_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2000` = cell_spec(`2000`, "latex", background = case_when(`2000_sig` == "HIGHER" ~ "#C3C3FF", `2000_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2001` = cell_spec(`2001`, "latex", background = case_when(`2001_sig` == "HIGHER" ~ "#C3C3FF", `2001_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2002` = cell_spec(`2002`, "latex", background = case_when(`2002_sig` == "HIGHER" ~ "#C3C3FF", `2002_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2003` = cell_spec(`2003`, "latex", background = case_when(`2003_sig` == "HIGHER" ~ "#C3C3FF", `2003_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2004` = cell_spec(`2004`, "latex", background = case_when(`2004_sig` == "HIGHER" ~ "#C3C3FF", `2004_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2005` = cell_spec(`2005`, "latex", background = case_when(`2005_sig` == "HIGHER" ~ "#C3C3FF", `2005_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2006` = cell_spec(`2006`, "latex", background = case_when(`2006_sig` == "HIGHER" ~ "#C3C3FF", `2006_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2007` = cell_spec(`2007`, "latex", background = case_when(`2007_sig` == "HIGHER" ~ "#C3C3FF", `2007_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2008` = cell_spec(`2008`, "latex", background = case_when(`2008_sig` == "HIGHER" ~ "#C3C3FF", `2008_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2009` = cell_spec(`2009`, "latex", background = case_when(`2009_sig` == "HIGHER" ~ "#C3C3FF", `2009_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2010` = cell_spec(`2010`, "latex", background = case_when(`2010_sig` == "HIGHER" ~ "#C3C3FF", `2010_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2011` = cell_spec(`2011`, "latex", background = case_when(`2011_sig` == "HIGHER" ~ "#C3C3FF", `2011_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#C3C3FF", `2012_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T) %>% kable_styling(latex_options = "scale_down")
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.2a: Housing characteristics by tenure - Dwelling type
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.2a)) {
Table_3.2a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2a)) {
if (length(grep("_2", colnames(Table_3.2a))) > 0) {
colnames(Table_3.2a) <- gsub("%", "\\\\%", colnames(Table_3.2a))
main_column_names <- colnames(Table_3.2a)[!grepl("_2", colnames(Table_3.2a))]
significance_column_names <- colnames(Table_3.2a)[grepl("_sig", colnames(Table_3.2a))]

Table_3.2a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.2a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2a) && length(grep("_2", colnames(Table_3.2a))) > 0) {
comparison_column_names <- colnames(Table_3.2a)[grepl("_2", colnames(Table_3.2a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.2a %>% select(tidyselect::all_of(colnames(Table_3.2a)[!colnames(Table_3.2a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.2b: Housing characteristics by tenure - SIMD
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.2b)) {
Table_3.2b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2b)) {
if (length(grep("_2", colnames(Table_3.2b))) > 0) {
colnames(Table_3.2b) <- gsub("%", "\\\\%", colnames(Table_3.2b))
main_column_names <- colnames(Table_3.2b)[!grepl("_2", colnames(Table_3.2b))]
significance_column_names <- colnames(Table_3.2b)[grepl("_sig", colnames(Table_3.2b))]

Table_3.2b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.2b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2b) && length(grep("_2", colnames(Table_3.2b))) > 0) {
comparison_column_names <- colnames(Table_3.2b)[grepl("_2", colnames(Table_3.2b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.2b %>% select(tidyselect::all_of(colnames(Table_3.2b)[!colnames(Table_3.2b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.2c: Housing characteristics by tenure - Urban / Rural Classification
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.2c)) {
Table_3.2c %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2c)) {
if (length(grep("_2", colnames(Table_3.2c))) > 0) {
colnames(Table_3.2c) <- gsub("%", "\\\\%", colnames(Table_3.2c))
main_column_names <- colnames(Table_3.2c)[!grepl("_2", colnames(Table_3.2c))]
significance_column_names <- colnames(Table_3.2c)[grepl("_sig", colnames(Table_3.2c))]

Table_3.2c %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.2c %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2c) && length(grep("_2", colnames(Table_3.2c))) > 0) {
comparison_column_names <- colnames(Table_3.2c)[grepl("_2", colnames(Table_3.2c))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.2c %>% select(tidyselect::all_of(colnames(Table_3.2c)[!colnames(Table_3.2c) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.2d: Housing characteristics by tenure - Number of bedrooms
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.2d)) {
Table_3.2d %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2d)) {
if (length(grep("_2", colnames(Table_3.2d))) > 0) {
colnames(Table_3.2d) <- gsub("%", "\\\\%", colnames(Table_3.2d))
main_column_names <- colnames(Table_3.2d)[!grepl("_2", colnames(Table_3.2d))]
significance_column_names <- colnames(Table_3.2d)[grepl("_sig", colnames(Table_3.2d))]

Table_3.2d %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.2d %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.2d) && length(grep("_2", colnames(Table_3.2d))) > 0) {
comparison_column_names <- colnames(Table_3.2d)[grepl("_2", colnames(Table_3.2d))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.2d %>% select(tidyselect::all_of(colnames(Table_3.2d)[!colnames(Table_3.2d) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.3a: Household characteristics by tenure - Number of people in household
### Column percentages, Households
### Excludes Refused and Don't know

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.3a)) {
Table_3.3a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3a)) {
if (length(grep("_2", colnames(Table_3.3a))) > 0) {
colnames(Table_3.3a) <- gsub("%", "\\\\%", colnames(Table_3.3a))
main_column_names <- colnames(Table_3.3a)[!grepl("_2", colnames(Table_3.3a))]
significance_column_names <- colnames(Table_3.3a)[grepl("_sig", colnames(Table_3.3a))]

Table_3.3a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.3a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3a) && length(grep("_2", colnames(Table_3.3a))) > 0) {
comparison_column_names <- colnames(Table_3.3a)[grepl("_2", colnames(Table_3.3a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.3a %>% select(tidyselect::all_of(colnames(Table_3.3a)[!colnames(Table_3.3a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.3b: Household characteristics by tenure - Household composition
### Column percentages, Households
### Excludes Refused and Don't know

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.3b)) {
Table_3.3b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3b)) {
if (length(grep("_2", colnames(Table_3.3b))) > 0) {
colnames(Table_3.3b) <- gsub("%", "\\\\%", colnames(Table_3.3b))
main_column_names <- colnames(Table_3.3b)[!grepl("_2", colnames(Table_3.3b))]
significance_column_names <- colnames(Table_3.3b)[grepl("_sig", colnames(Table_3.3b))]

Table_3.3b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.3b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3b) && length(grep("_2", colnames(Table_3.3b))) > 0) {
comparison_column_names <- colnames(Table_3.3b)[grepl("_2", colnames(Table_3.3b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.3b %>% select(tidyselect::all_of(colnames(Table_3.3b)[!colnames(Table_3.3b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.3c: Household characteristics by tenure - Age
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.3c)) {
Table_3.3c %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3c)) {
if (length(grep("_2", colnames(Table_3.3c))) > 0) {
colnames(Table_3.3c) <- gsub("%", "\\\\%", colnames(Table_3.3c))
main_column_names <- colnames(Table_3.3c)[!grepl("_2", colnames(Table_3.3c))]
significance_column_names <- colnames(Table_3.3c)[grepl("_sig", colnames(Table_3.3c))]

Table_3.3c %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.3c %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3c) && length(grep("_2", colnames(Table_3.3c))) > 0) {
comparison_column_names <- colnames(Table_3.3c)[grepl("_2", colnames(Table_3.3c))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.3c %>% select(tidyselect::all_of(colnames(Table_3.3c)[!colnames(Table_3.3c) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.3d: Household characteristics by tenure - Number of cars
### Column percentages, Households
### Excludes Refused and Don't know

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.3d)) {
Table_3.3d %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3d)) {
if (length(grep("_2", colnames(Table_3.3d))) > 0) {
colnames(Table_3.3d) <- gsub("%", "\\\\%", colnames(Table_3.3d))
main_column_names <- colnames(Table_3.3d)[!grepl("_2", colnames(Table_3.3d))]
significance_column_names <- colnames(Table_3.3d)[grepl("_sig", colnames(Table_3.3d))]

Table_3.3d %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.3d %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3d) && length(grep("_2", colnames(Table_3.3d))) > 0) {
comparison_column_names <- colnames(Table_3.3d)[grepl("_2", colnames(Table_3.3d))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.3d %>% select(tidyselect::all_of(colnames(Table_3.3d)[!colnames(Table_3.3d) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.3e: Household characteristics by tenure - Net household income
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.3e)) {
Table_3.3e %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3e)) {
if (length(grep("_2", colnames(Table_3.3e))) > 0) {
colnames(Table_3.3e) <- gsub("%", "\\\\%", colnames(Table_3.3e))
main_column_names <- colnames(Table_3.3e)[!grepl("_2", colnames(Table_3.3e))]
significance_column_names <- colnames(Table_3.3e)[grepl("_sig", colnames(Table_3.3e))]

Table_3.3e %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.3e %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3e) && length(grep("_2", colnames(Table_3.3e))) > 0) {
comparison_column_names <- colnames(Table_3.3e)[grepl("_2", colnames(Table_3.3e))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.3e %>% select(tidyselect::all_of(colnames(Table_3.3e)[!colnames(Table_3.3e) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.3f: How well household is managing financially
### Column percentages, Households
### Excludes Refused and Don't know. The "Manage well" category has been created by combining the response categories "Manages very well" and "Manages quite well". The "Does not manage well" category has been created by combining the response categories "Doesn't manage very well", "Has some financial difficulties" and "Is in deep financial trouble"

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.3f)) {
Table_3.3f %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3f)) {
if (length(grep("_2", colnames(Table_3.3f))) > 0) {
colnames(Table_3.3f) <- gsub("%", "\\\\%", colnames(Table_3.3f))
main_column_names <- colnames(Table_3.3f)[!grepl("_2", colnames(Table_3.3f))]
significance_column_names <- colnames(Table_3.3f)[grepl("_sig", colnames(Table_3.3f))]

Table_3.3f %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.3f %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.3f) && length(grep("_2", colnames(Table_3.3f))) > 0) {
comparison_column_names <- colnames(Table_3.3f)[grepl("_2", colnames(Table_3.3f))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.3f %>% select(tidyselect::all_of(colnames(Table_3.3f)[!colnames(Table_3.3f) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.4a: Adult characteristics by tenure - Ethnicity
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.4a)) {
Table_3.4a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.4a)) {
if (length(grep("_2", colnames(Table_3.4a))) > 0) {
colnames(Table_3.4a) <- gsub("%", "\\\\%", colnames(Table_3.4a))
main_column_names <- colnames(Table_3.4a)[!grepl("_2", colnames(Table_3.4a))]
significance_column_names <- colnames(Table_3.4a)[grepl("_sig", colnames(Table_3.4a))]

Table_3.4a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.4a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.4a) && length(grep("_2", colnames(Table_3.4a))) > 0) {
comparison_column_names <- colnames(Table_3.4a)[grepl("_2", colnames(Table_3.4a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.4a %>% select(tidyselect::all_of(colnames(Table_3.4a)[!colnames(Table_3.4a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.4b: Adult characteristics by tenure - Economic situation
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.4b)) {
Table_3.4b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.4b)) {
if (length(grep("_2", colnames(Table_3.4b))) > 0) {
colnames(Table_3.4b) <- gsub("%", "\\\\%", colnames(Table_3.4b))
main_column_names <- colnames(Table_3.4b)[!grepl("_2", colnames(Table_3.4b))]
significance_column_names <- colnames(Table_3.4b)[grepl("_sig", colnames(Table_3.4b))]

Table_3.4b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.4b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.4b) && length(grep("_2", colnames(Table_3.4b))) > 0) {
comparison_column_names <- colnames(Table_3.4b)[grepl("_2", colnames(Table_3.4b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.4b %>% select(tidyselect::all_of(colnames(Table_3.4b)[!colnames(Table_3.4b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.4c: Adult characteristics by tenure - Length of time at current address
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.4c)) {
Table_3.4c %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.4c)) {
if (length(grep("_2", colnames(Table_3.4c))) > 0) {
colnames(Table_3.4c) <- gsub("%", "\\\\%", colnames(Table_3.4c))
main_column_names <- colnames(Table_3.4c)[!grepl("_2", colnames(Table_3.4c))]
significance_column_names <- colnames(Table_3.4c)[grepl("_sig", colnames(Table_3.4c))]

Table_3.4c %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.4c %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.4c) && length(grep("_2", colnames(Table_3.4c))) > 0) {
comparison_column_names <- colnames(Table_3.4c)[grepl("_2", colnames(Table_3.4c))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.4c %>% select(tidyselect::all_of(colnames(Table_3.4c)[!colnames(Table_3.4c) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.4d: Adult characteristics by tenure - Tenure of previous address
### Base numbers at local authority level are too small to produce robust analysis.
### Only asked of those who have been at their current address for less than a year
## Table 3.4e: Adult characteristics by tenure - Whether the change of address was to join an existing family/household, or to occupy the entire property
### Base numbers at local authority level are too small to produce robust analysis.
### Only asked of those who have been at their current address for less than a year
## Table 3.5a: Views on housing aspirations, by tenure - Reasons for moving to the area
### Column percentages, Adults
### Columns may not add up 100 per cent as multiple responses were allowed

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.5a)) {
Table_3.5a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.5a)) {
if (length(grep("_2", colnames(Table_3.5a))) > 0) {
colnames(Table_3.5a) <- gsub("%", "\\\\%", colnames(Table_3.5a))
main_column_names <- colnames(Table_3.5a)[!grepl("_2", colnames(Table_3.5a))]
significance_column_names <- colnames(Table_3.5a)[grepl("_sig", colnames(Table_3.5a))]

Table_3.5a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.5a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.5a) && length(grep("_2", colnames(Table_3.5a))) > 0) {
comparison_column_names <- colnames(Table_3.5a)[grepl("_2", colnames(Table_3.5a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.5a %>% select(tidyselect::all_of(colnames(Table_3.5a)[!colnames(Table_3.5a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.5b: Views on housing aspirations, by tenure - When the household expects to move
### Column percentages, Adults
### No data prior to 2015 available. Base sizes too small for breakdown by tenure

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.5b)) {
Table_3.5b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.5b)) {
if (length(grep("_2", colnames(Table_3.5b))) > 0) {
colnames(Table_3.5b) <- gsub("%", "\\\\%", colnames(Table_3.5b))
main_column_names <- colnames(Table_3.5b)[!grepl("_2", colnames(Table_3.5b))]
significance_column_names <- colnames(Table_3.5b)[grepl("_sig", colnames(Table_3.5b))]

Table_3.5b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.5b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.5b) && length(grep("_2", colnames(Table_3.5b))) > 0) {
comparison_column_names <- colnames(Table_3.5b)[grepl("_2", colnames(Table_3.5b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.5b %>% select(tidyselect::all_of(colnames(Table_3.5b)[!colnames(Table_3.5b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.6a: Views on housing aspirations, by tenure - Accommodation householder would like to live in
### Column percentages, Adults
### No data prior to 2015 available

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.6a)) {
Table_3.6a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.6a)) {
if (length(grep("_2", colnames(Table_3.6a))) > 0) {
colnames(Table_3.6a) <- gsub("%", "\\\\%", colnames(Table_3.6a))
main_column_names <- colnames(Table_3.6a)[!grepl("_2", colnames(Table_3.6a))]
significance_column_names <- colnames(Table_3.6a)[grepl("_sig", colnames(Table_3.6a))]

Table_3.6a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.6a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.6a) && length(grep("_2", colnames(Table_3.6a))) > 0) {
comparison_column_names <- colnames(Table_3.6a)[grepl("_2", colnames(Table_3.6a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.6a %>% select(tidyselect::all_of(colnames(Table_3.6a)[!colnames(Table_3.6a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.6b: Compared to current accommodation, the size of property householder would most like to live in
### Column percentages, Households
### New question as of 2018. Excludes Refused and Don't know

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.6b)) {
Table_3.6b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.6b)) {
if (length(grep("_2", colnames(Table_3.6b))) > 0) {
colnames(Table_3.6b) <- gsub("%", "\\\\%", colnames(Table_3.6b))
main_column_names <- colnames(Table_3.6b)[!grepl("_2", colnames(Table_3.6b))]
significance_column_names <- colnames(Table_3.6b)[grepl("_sig", colnames(Table_3.6b))]

Table_3.6b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.6b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.6b) && length(grep("_2", colnames(Table_3.6b))) > 0) {
comparison_column_names <- colnames(Table_3.6b)[grepl("_2", colnames(Table_3.6b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.6b %>% select(tidyselect::all_of(colnames(Table_3.6b)[!colnames(Table_3.6b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.6c: Barriers to moving to the accommodation the householder would most like to live i
### Base numbers at local authority level are too small to produce robust analysis.
## Figure 3.6: Percentage of households very or fairly satisfied with housing
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Figure_3.6)) {
Figure_3.6 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.6)) {
if (length(grep("_2", colnames(Figure_3.6))) > 0) {
colnames(Figure_3.6) <- gsub("%", "\\\\%", colnames(Figure_3.6))
main_column_names <- colnames(Figure_3.6)[!grepl("_2", colnames(Figure_3.6))]
significance_column_names <- colnames(Figure_3.6)[grepl("_sig", colnames(Figure_3.6))]

Figure_3.6 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#00A3A3", `2012_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Figure_3.6 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Figure_3.6) && length(grep("_2", colnames(Figure_3.6))) > 0) {
comparison_column_names <- colnames(Figure_3.6)[grepl("_2", colnames(Figure_3.6))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Figure_3.6 %>% select(tidyselect::all_of(colnames(Figure_3.6)[!colnames(Figure_3.6) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2012` = cell_spec(`2012`, "latex", background = case_when(`2012_sig` == "HIGHER" ~ "#C3C3FF", `2012_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.7a: Views on neighbourhood and housing aspirations, by tenure - Rating of neighbourhood as a place to live
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.7a)) {
Table_3.7a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.7a)) {
if (length(grep("_2", colnames(Table_3.7a))) > 0) {
colnames(Table_3.7a) <- gsub("%", "\\\\%", colnames(Table_3.7a))
main_column_names <- colnames(Table_3.7a)[!grepl("_2", colnames(Table_3.7a))]
significance_column_names <- colnames(Table_3.7a)[grepl("_sig", colnames(Table_3.7a))]

Table_3.7a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.7a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.7a) && length(grep("_2", colnames(Table_3.7a))) > 0) {
comparison_column_names <- colnames(Table_3.7a)[grepl("_2", colnames(Table_3.7a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.7a %>% select(tidyselect::all_of(colnames(Table_3.7a)[!colnames(Table_3.7a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.7b: Views on neighbourhoods and housing aspirations, by tenure - Strength of belonging to immediate neighbourhood
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.7b)) {
Table_3.7b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.7b)) {
if (length(grep("_2", colnames(Table_3.7b))) > 0) {
colnames(Table_3.7b) <- gsub("%", "\\\\%", colnames(Table_3.7b))
main_column_names <- colnames(Table_3.7b)[!grepl("_2", colnames(Table_3.7b))]
significance_column_names <- colnames(Table_3.7b)[grepl("_sig", colnames(Table_3.7b))]

Table_3.7b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.7b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.7b) && length(grep("_2", colnames(Table_3.7b))) > 0) {
comparison_column_names <- colnames(Table_3.7b)[grepl("_2", colnames(Table_3.7b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.7b %>% select(tidyselect::all_of(colnames(Table_3.7b)[!colnames(Table_3.7b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.7c: Views on neighbourhoods and housing aspirations, by tenure - Housing satisfaction
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.7c)) {
Table_3.7c %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.7c)) {
if (length(grep("_2", colnames(Table_3.7c))) > 0) {
colnames(Table_3.7c) <- gsub("%", "\\\\%", colnames(Table_3.7c))
main_column_names <- colnames(Table_3.7c)[!grepl("_2", colnames(Table_3.7c))]
significance_column_names <- colnames(Table_3.7c)[grepl("_sig", colnames(Table_3.7c))]

Table_3.7c %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.7c %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.7c) && length(grep("_2", colnames(Table_3.7c))) > 0) {
comparison_column_names <- colnames(Table_3.7c)[grepl("_2", colnames(Table_3.7c))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.7c %>% select(tidyselect::all_of(colnames(Table_3.7c)[!colnames(Table_3.7c) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.8: Households renting privately  information on landlord / letting agents and deposits
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.9a: Limiting activities by tenure - Household has someone with a long-term physical/mental health condition/illness
### Column percentages, Adults
### A long-term condition is defined as lasting or expecting to last for 12 months or more

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.9a)) {
Table_3.9a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.9a)) {
if (length(grep("_2", colnames(Table_3.9a))) > 0) {
colnames(Table_3.9a) <- gsub("%", "\\\\%", colnames(Table_3.9a))
main_column_names <- colnames(Table_3.9a)[!grepl("_2", colnames(Table_3.9a))]
significance_column_names <- colnames(Table_3.9a)[grepl("_sig", colnames(Table_3.9a))]

Table_3.9a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.9a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.9a) && length(grep("_2", colnames(Table_3.9a))) > 0) {
comparison_column_names <- colnames(Table_3.9a)[grepl("_2", colnames(Table_3.9a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.9a %>% select(tidyselect::all_of(colnames(Table_3.9a)[!colnames(Table_3.9a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.9b: Limiting activities by tenure - What about the home limits activities that can be done
### Base numbers at local authority level are too small to produce robust analysis.
### Asked of households with someone with a long-term condition/illness
## Table 3.9c: Limiting activities by tenure - Whether the home requires adaptations to  make it easier to go about daily activities
### Base numbers at local authority level are too small to produce robust analysis.
### Asked of households with someone with a long-term condition/illness
## Table 3.10a: Housing adaptations and support - Home adaptations that are already in place
### Column percentages, Households
### Columns may not add up 100 per cent as multiple responses were allowed. Base sizes too small for breakdown by tenure

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.10a)) {
Table_3.10a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.10a)) {
if (length(grep("_2", colnames(Table_3.10a))) > 0) {
colnames(Table_3.10a) <- gsub("%", "\\\\%", colnames(Table_3.10a))
main_column_names <- colnames(Table_3.10a)[!grepl("_2", colnames(Table_3.10a))]
significance_column_names <- colnames(Table_3.10a)[grepl("_sig", colnames(Table_3.10a))]

Table_3.10a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.10a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.10a) && length(grep("_2", colnames(Table_3.10a))) > 0) {
comparison_column_names <- colnames(Table_3.10a)[grepl("_2", colnames(Table_3.10a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.10a %>% select(tidyselect::all_of(colnames(Table_3.10a)[!colnames(Table_3.10a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.10b: Housing adaptations and support - Services that household members currently receive
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.10b)) {
Table_3.10b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.10b)) {
if (length(grep("_2", colnames(Table_3.10b))) > 0) {
colnames(Table_3.10b) <- gsub("%", "\\\\%", colnames(Table_3.10b))
main_column_names <- colnames(Table_3.10b)[!grepl("_2", colnames(Table_3.10b))]
significance_column_names <- colnames(Table_3.10b)[grepl("_sig", colnames(Table_3.10b))]

Table_3.10b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.10b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.10b) && length(grep("_2", colnames(Table_3.10b))) > 0) {
comparison_column_names <- colnames(Table_3.10b)[grepl("_2", colnames(Table_3.10b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.10b %>% select(tidyselect::all_of(colnames(Table_3.10b)[!colnames(Table_3.10b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.11a: Households on a housing list by tenure - Whether household is on a housing list
### Column percentages, Households
### Respondents who have said that either they have never looked for social housing or that they have looked for social housing but are not currently on a list

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.11a)) {
Table_3.11a %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.11a)) {
if (length(grep("_2", colnames(Table_3.11a))) > 0) {
colnames(Table_3.11a) <- gsub("%", "\\\\%", colnames(Table_3.11a))
main_column_names <- colnames(Table_3.11a)[!grepl("_2", colnames(Table_3.11a))]
significance_column_names <- colnames(Table_3.11a)[grepl("_sig", colnames(Table_3.11a))]

Table_3.11a %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.11a %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.11a) && length(grep("_2", colnames(Table_3.11a))) > 0) {
comparison_column_names <- colnames(Table_3.11a)[grepl("_2", colnames(Table_3.11a))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.11a %>% select(tidyselect::all_of(colnames(Table_3.11a)[!colnames(Table_3.11a) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.11b: Households on a housing list by tenure - If not on a housing list, whether household has applied for social housing under a choice-based letting scheme, or similar, in the last year
### Column percentages, Households
### No data prior to 2017 available. Respondents who have said that either they have never looked for social housing or that they have looked for social housing but are not currently on a list

### `r main_table_title`

```{r eval=(eval_comparison == FALSE)}
if (!is.null(Table_3.11b)) {
Table_3.11b %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison}
if (!is.null(Table_3.11b)) {
if (length(grep("_2", colnames(Table_3.11b))) > 0) {
colnames(Table_3.11b) <- gsub("%", "\\\\%", colnames(Table_3.11b))
main_column_names <- colnames(Table_3.11b)[!grepl("_2", colnames(Table_3.11b))]
significance_column_names <- colnames(Table_3.11b)[grepl("_sig", colnames(Table_3.11b))]

Table_3.11b %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#00A3A3", `Owner occupier_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#00A3A3", `Social sector_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#00A3A3", `Private rent_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#00A3A3", `Other_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.11b %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison}
if (!is.null(Table_3.11b) && length(grep("_2", colnames(Table_3.11b))) > 0) {
comparison_column_names <- colnames(Table_3.11b)[grepl("_2", colnames(Table_3.11b))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.11b %>% select(tidyselect::all_of(colnames(Table_3.11b)[!colnames(Table_3.11b) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`Owner occupier` = cell_spec(`Owner occupier`, "latex", background = case_when(`Owner occupier_sig` == "HIGHER" ~ "#C3C3FF", `Owner occupier_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Social sector` = cell_spec(`Social sector`, "latex", background = case_when(`Social sector_sig` == "HIGHER" ~ "#C3C3FF", `Social sector_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Private rent` = cell_spec(`Private rent`, "latex", background = case_when(`Private rent_sig` == "HIGHER" ~ "#C3C3FF", `Private rent_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`Other` = cell_spec(`Other`, "latex", background = case_when(`Other_sig` == "HIGHER" ~ "#C3C3FF", `Other_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.11c: Households on a housing list by tenure - The number of housing lists that households are on (households on a list)
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.11d: Households on a housing list by tenure - How long the household has been on a housing list (households on a list)
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.11e: Households on a housing list by tenure - The main reason for household being on a housing list (households on a list)
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.12: Adults on housing lists
### Column percentages, Adults

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_3.12)) {
Table_3.12 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_3.12)) {
if (length(grep("_2", colnames(Table_3.12))) > 0) {
colnames(Table_3.12) <- gsub("%", "\\\\%", colnames(Table_3.12))
main_column_names <- colnames(Table_3.12)[!grepl("_2", colnames(Table_3.12))]
significance_column_names <- colnames(Table_3.12)[grepl("_sig", colnames(Table_3.12))]

Table_3.12 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.12 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_3.12) && length(grep("_2", colnames(Table_3.12))) > 0) {
comparison_column_names <- colnames(Table_3.12)[grepl("_2", colnames(Table_3.12))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.12 %>% select(tidyselect::all_of(colnames(Table_3.12)[!colnames(Table_3.12) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.13: Households on housing lists
### Column percentages, Households

### `r main_table_title`

```{r eval=(eval_comparison_time_series == FALSE)}
if (!is.null(Table_3.13)) {
Table_3.13 %>%
kable("latex", escape = TRUE, booktabs = T)
 } else {
        asis_output("### There is no data to show for this table within the specified parameters")
      }
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_3.13)) {
if (length(grep("_2", colnames(Table_3.13))) > 0) {
colnames(Table_3.13) <- gsub("%", "\\\\%", colnames(Table_3.13))
main_column_names <- colnames(Table_3.13)[!grepl("_2", colnames(Table_3.13))]
significance_column_names <- colnames(Table_3.13)[grepl("_sig", colnames(Table_3.13))]

Table_3.13 %>% select(tidyselect::all_of(main_column_names)) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#00A3A3", `2013_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#00A3A3", `2014_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#00A3A3", `2015_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#00A3A3", `2016_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#00A3A3", `2017_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#00A3A3", `2018_sig` == "LOWER" ~ "#C3C3FF", TRUE ~ "#FFFFFF"))

) %>%
select(!tidyselect::all_of(significance_column_names)) %>%
kable("latex", escape = FALSE, booktabs = T)
} else {
Table_3.13 %>%
kable("latex", escape = TRUE, booktabs = T)
}
} else {
  asis_output("### There is no data to show for this table within the specified parameters")
}
```
```{r eval=eval_comparison_time_series}
asis_output(paste0("### ", comparison_table_title))
```

```{r eval=eval_comparison_time_series}
if (!is.null(Table_3.13) && length(grep("_2", colnames(Table_3.13))) > 0) {
comparison_column_names <- colnames(Table_3.13)[grepl("_2", colnames(Table_3.13))]
comparison_rename_column_names <- gsub("_2", "", comparison_column_names)

Table_3.13 %>% select(tidyselect::all_of(colnames(Table_3.13)[!colnames(Table_3.13) %in% comparison_rename_column_names])) %>%
rename_at(comparison_column_names, ~ comparison_rename_column_names) %>%
mutate(`2013` = cell_spec(`2013`, "latex", background = case_when(`2013_sig` == "HIGHER" ~ "#C3C3FF", `2013_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2014` = cell_spec(`2014`, "latex", background = case_when(`2014_sig` == "HIGHER" ~ "#C3C3FF", `2014_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2015` = cell_spec(`2015`, "latex", background = case_when(`2015_sig` == "HIGHER" ~ "#C3C3FF", `2015_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2016` = cell_spec(`2016`, "latex", background = case_when(`2016_sig` == "HIGHER" ~ "#C3C3FF", `2016_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2017` = cell_spec(`2017`, "latex", background = case_when(`2017_sig` == "HIGHER" ~ "#C3C3FF", `2017_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF")),
`2018` = cell_spec(`2018`, "latex", background = case_when(`2018_sig` == "HIGHER" ~ "#C3C3FF", `2018_sig` == "LOWER" ~ "#00A3A3", TRUE ~ "#FFFFFF"))) %>%
        select(!tidyselect::all_of(significance_column_names)) %>%
        kable("latex", escape = FALSE, booktabs = T)
} else {
asis_output("### There is no data to show for this table within the specified parameters")
}
```
## Table 3.14: Urban Rural Location of Private Rented Households, by year
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.15: Age of Highest Income Householder in Private Rented Households, by year
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.16: Household Composition of Private Rented Households, by year
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.17: Economic situation of Adults in Private Rented Households, by year
### Base numbers at local authority level are too small to produce robust analysis.
## Table 3.18: Length of Time at address in private rented households, by year
### Base numbers at local authority level are too small to produce robust analysis.
